<div class="page-header">
    <h1>Add Books</h1>
    <div class="page-header-actions">
        <a href="/my-books" class="btn btn-secondary">Back to My Books</a>
    </div>
</div>

<section class="section">
    <form method="GET" action="/my-books/search" class="form form-inline search-form">
        <div class="form-group">
            <input type="text" name="q" value="{{.Query}}" placeholder="Search for books..." autofocus
                   hx-get="/my-books/search"
                   hx-trigger="input changed delay:500ms, search"
                   hx-target="#search-results"
                   hx-indicator="#search-indicator">
        </div>
        <span id="search-indicator" class="htmx-indicator search-indicator">Searching...</span>
    </form>
</section>

<div id="search-results">
{{if .Error}}
<div class="error-message">{{.Error}}</div>
{{end}}

{{if .Results}}
<section class="section">
    <h2>Search Results</h2>
    <div class="search-results">
        {{range .Results}}
        <div class="search-result-item">
            {{if .GoogleBooksID}}
            <img src="/api/images/book/{{.GoogleBooksID}}" alt="{{.Title}}" class="book-thumb">
            {{else}}
            <div class="book-thumb-placeholder"></div>
            {{end}}
            <div class="book-details">
                <strong>{{.Title}}</strong>
                {{if .Authors}}<br><span class="authors">{{.Authors}}</span>{{end}}
            </div>
            <a href="/my-books/add?google_books_id={{.GoogleBooksID}}&title={{urlquery .Title}}&authors={{urlquery .Authors}}&thumbnail_url={{urlquery .ThumbnailURL}}&q={{urlquery $.Query}}" class="btn btn-primary btn-small">Add</a>
        </div>
        {{end}}
    </div>
</section>
{{else if .Query}}
<p class="empty-state">No results found for "{{.Query}}".</p>
{{end}}
</div>
